<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/styles.css" />
    <script src="js/main.js" defer></script>
    <title>Simulacro</title>
  </head>
  
  <body>

    <header>
      
        <nav class="nav-principal">
            <span class="titulo">Musical shop</span>

            <div>
                <span id="nombreAlumno"></span>
                <input id="barraBusqueda" type="text", placeholder="Buscar...">
            </div>

            <span id="contadorCarrito">Carrito: 0 productos</span>
        </nav>

        <nav class="nav-secundario">
          <ul class="nav-links">
            <li><a href="index.html">Ver</a></li>
            <li><a href="consultar.html">Consultar ID</a></li>
            <li><a href="crear.html">Crear</a></li>
            <li><a href="modificar.html">Modificar</a></li>
            <li><a href="eliminar.html">Eliminar</a></li>
          </ul>
        </nav>
        
    </header>

    <main>
        <h2>Lista de productos</h2>

        <div class="botones-orden">
            <button onclick="ordenarPorNombre()">Ordenar por nombre</button>
            <button onclick="ordenarPorPrecio()">Ordenar por precio</button>
        </div>

        <div id="totalCarrito"></div>

        <div id="contenedor-productos"></div>
    </main> 
        
    <script>
      // Seleccionamos el elemento al que le vamos a inyectar el html
      const contenedorProductos = document.getElementById("contenedor-productos");
      const url = "http://localhost:3000/api/productos" // guardamos en la variable url nuestro endpoint

      async function obtenerProductos (){
        try {
          let respuesta = await fetch(url) // Hacemos una peticion al nuevo endpoint

          let data = await respuesta.json()

          console.log(data);

          let productos = data.payload; // guardamos en la variable producto el array de productos que contiene payload

          console.table(productos);

          mostrarProductos(productos);


        } catch (error) {
          console.error(error);
        }
      }

      function mostrarProductos(array){
        console.table(array); // Recibimos en formato tabla los productos que nos manda la funcion obtenerProductos
      
        let htmlProducto = "";

        array.forEach(producto => {
          htmlProducto += `
              <div class="card-producto">
                  <img src="${producto.imagen}" alt="${producto.nombre}">
                  <h5>${producto.nombre}</h5>
                  <p>ID: ${producto.id}</p>
                  <p>$${producto.precio}</p>
            </div>
          `;
        });

        contenedorProductos.innerHTML = htmlProducto;
      }
      

      function init(){
        obtenerProductos();
        mostrarProductos();
      }

      init();

    </script>
  </body>
</html>
